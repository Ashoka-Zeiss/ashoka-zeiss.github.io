<!DOCTYPE html>
<html lang="en" style="scroll-behavior: smooth;">

<head>
  <meta charset=" UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Professional Course in Advanced Microscopy | Course Schedule</title>
  <style>
    /* CSS Reset and Custom Properties */
    :root {
      /* Light mode colors */
      --color-bg: #ffffff;
      --color-surface: #f8f9fa;
      --color-surface-hover: #e9ecef;
      --color-text-primary: #212529;
      --color-text-secondary: #6c757d;
      --color-text-muted: #adb5bd;

      /* Category Colors */
      --color-online: #0096c7;
      --color-campus: #f77f00;
      --color-offcampus: #7209b7;

      /* Lab Type Colors - Subtle accents */
      --color-theory: #06ffa5;
      --color-wet-lab: #ff006e;
      --color-dry-lab: #0582ca;
      --color-computational: #06ffa5;

      /* UI Colors */
      --color-border: #dee2e6;
      --color-accent: #0096c7;

      /* Typography - Following Butterick's Principles */
      --font-sans: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', Roboto, sans-serif;
      --font-size-base: 16px;
      --line-height-base: 1.5;
      --line-height-heading: 1.3;

      /* Spacing Scale */
      --space-xs: 0.5rem;
      --space-sm: 0.75rem;
      --space-md: 1rem;
      --space-lg: 1.5rem;
      --space-xl: 2rem;
      --space-2xl: 3rem;

      /* Layout */
      --container-max: 1200px;
      --border-radius: 8px;
      --transition-base: 150ms ease-in-out;

      /* New Design System Additions */
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.06);
      --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.08);
      --shadow-lg: 0 4px 24px rgba(0, 0, 0, 0.06);
      --shadow-xl: 0 20px 60px rgba(0, 0, 0, 0.3);

      /* Enhanced border radius */
      --border-radius-lg: 12px;
      --border-radius-xl: 16px;

      /* Transitions */
      --transition-smooth: 200ms ease-out;
      --transition-bounce: 300ms cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    /* Dark mode */
    [data-theme="dark"] {
      --color-bg: #1a1a1a;
      --color-surface: #242424;
      --color-surface-hover: #2a2a2a;
      --color-text-primary: #ffffff;
      --color-text-secondary: #a0a0a0;
      --color-text-muted: #6b6b6b;

      /* Category Colors */
      --color-online: #00D9D9;
      --color-campus: #FFB000;
      --color-offcampus: #8B5CF6;

      /* Lab Type Colors */
      --color-theory: #4ECDC4;
      --color-wet-lab: #FF6B6B;
      --color-dry-lab: #4DABF7;
      --color-computational: #51CF66;

      /* UI Colors */
      --color-border: #333333;
      --color-accent: #00D9D9;

      /* Dark mode shadows */
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.2);
      --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.3);
      --shadow-lg: 0 4px 24px rgba(0, 0, 0, 0.4);
      --shadow-xl: 0 20px 60px rgba(0, 0, 0, 0.5);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-sans);
      font-size: var(--font-size-base);
      line-height: var(--line-height-base);
      background-color: #f5f5f7;
      /* Changed from var(--color-bg) */
      color: var(--color-text-primary);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: background-color var(--transition-base), color var(--transition-base);
    }

    /* Add dark mode body background */
    [data-theme="dark"] body {
      background-color: #0a0a0a;
      /* Darker background for better contrast */
    }

    /* Container and Layout */
    .container {
      max-width: var(--container-max);
      margin: 0 auto;
      padding: var(--space-md);
      overflow-x: hidden;
    }

    /* Header and Footer */
    /**
    .header {
      margin-bottom: var(--space-xl);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header h1 {
      font-size: 1.75rem;
      font-weight: 600;
      line-height: var(--line-height-heading);
    }

    **/
    /* Main Header */
    .main-header {
      background-color: var(--color-bg);
      border-bottom: 1px solid var(--color-border);
      padding: var(--space-lg) 0;
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(8px);
    }

    .header-container {
      max-width: var(--container-max);
      margin: 0 auto;
      padding: 0 var(--space-md);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: var(--space-xl);
    }

    .logo-section {
      position: relative;
      height: 96px;
      width: 96px;
      flex-shrink: 0;
    }

    .header-logo {
      height: 100%;
      width: 100%;
      object-fit: contain;
      transition: opacity var(--transition-base);
    }

    .light-logo {
      opacity: 1;
    }

    .dark-logo {
      opacity: 0;
      position: absolute;
      top: 0;
      left: 0;
    }

    [data-theme="dark"] .light-logo {
      opacity: 0;
    }

    [data-theme="dark"] .dark-logo {
      opacity: 1;
    }

    .header-text {
      display: flex;
      flex-direction: column;
      gap: var(--space-xs);
    }

    .course-title {
      font-size: 1.5rem;
      padding-left: 12px;
      font-weight: 600;
      line-height: var(--line-height-heading);
      color: var(--color-text-primary);
      margin: 0;
    }

    .course-subtitle {
      font-size: 0.875rem;
      padding-left: 12px;
      color: var(--color-text-secondary);
      margin: 0;
      font-weight: 400;
    }

    .header-right {
      display: flex;
      align-items: center;
    }

    .title-short {
      display: none;
    }

    /* Enhanced Mobile Header Responsiveness */
    @media (max-width: 1024px) {
      .course-title {
        font-size: 1.375rem;
        padding-left: 10px;
      }

      .course-subtitle {
        font-size: 0.8125rem;
        padding-left: 10px;
      }
    }

    @media (max-width: 768px) {
      .header-container {
        gap: var(--space-md);
      }

      .header-left {
        gap: var(--space-md);
        flex: 1;
        min-width: 0;
        /* Allow text to shrink */
      }

      .header-text {
        flex: 1;
        min-width: 0;
        /* Allow text to shrink */
      }

      .course-title {
        font-size: 1.25rem;
        line-height: 1.2;
        padding-left: 10px;
        word-wrap: break-word;
        hyphens: auto;
      }

      .course-subtitle {
        font-size: 0.75rem;
        padding-left: 10px;
        line-height: 1.3;
      }

      .header-right {
        flex-shrink: 0;
        /* Prevent theme button from shrinking */
      }
    }

    @media (max-width: 640px) {
      .main-header {
        padding: var(--space-md) 0;
      }

      .header-left {
        gap: var(--space-sm);
      }

      .course-title {
        font-size: 1.125rem;
        padding-left: 6px;
        line-height: 1.2;
      }

      .course-subtitle {
        padding-left: 6px;
        font-size: 0.6875rem;
        line-height: 1.3;
      }

      .logo-section {
        height: 40px;
        width: 40px;
      }
    }

    /* Very small screens - stack layout if needed */
    @media (max-width: 480px) {
      .header-container {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--space-md);
      }

      .header-left {
        width: 100%;
        gap: var(--space-md);
      }

      .header-right {
        position: absolute;
        top: var(--space-md);
        right: var(--space-md);
      }

      .title-full {
        display: none;
      }

      .title-short {
        display: inline;
      }

      .course-title {
        font-size: 1.25rem;
        padding-left: 6px;
        padding-right: 60px;
        /* Make room for theme button */
      }

      .course-subtitle {
        font-size: 0.75rem;
        padding-left: 6px;
        padding-right: 60px;
        /* Make room for theme button */
      }
    }

    /* Extra small screens */
    @media (max-width: 360px) {
      .course-title {
        font-size: 1.125rem;
        padding-right: 60px;
      }

      .course-subtitle {
        font-size: 0.6875rem;
      }

      .logo-section {
        height: 36px;
        width: 36px;
      }
    }

    /* Footer */
    /* Footer Redesign */
    .main-footer {
      background-color: var(--color-surface);
      border-top: 1px solid var(--color-border);
      margin-top: var(--space-2xl);
      padding: var(--space-2xl) 0 var(--space-lg) 0;
    }

    .footer-container {
      max-width: var(--container-max);
      margin: 0 auto;
      padding: 0 var(--space-md);
    }

    .footer-content {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr;
      gap: var(--space-2xl);
      margin-bottom: var(--space-xl);
    }

    .footer-section {
      display: flex;
      flex-direction: column;
      gap: var(--space-md);
    }

    .footer-heading {
      font-size: 1.125rem;
      font-weight: 600;
      color: var(--color-text-primary);
      margin: 0;
      line-height: var(--line-height-heading);
    }

    .footer-subheading {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--color-text-primary);
      margin: 0;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .footer-description {
      font-size: 0.875rem;
      color: var(--color-text-secondary);
      margin: 0;
      line-height: 1.6;
    }

    .footer-links {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
    }

    .footer-link {
      color: var(--color-text-secondary);
      text-decoration: none;
      font-size: 0.875rem;
      transition: color var(--transition-base);
    }

    .footer-link:hover {
      color: var(--color-accent);
      text-decoration: underline;
    }

    /* Footer Bottom */
    .footer-bottom {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: var(--space-lg);
      border-top: 1px solid var(--color-border);
    }

    .footer-copyright {
      font-size: 0.75rem;
      color: var(--color-text-muted);
      margin: 0;
    }

    .footer-credits {
      font-size: 0.75rem;
      color: var(--color-text-muted);
      margin: 0;
    }

    .footer-credits .footer-link {
      font-size: 0.75rem;
      color: var(--color-text-secondary);
    }

    /* Responsive Footer */
    @media (max-width: 1024px) {
      .footer-content {
        grid-template-columns: 1fr 1fr;
        gap: var(--space-xl);
      }

      .footer-section:first-child {
        grid-column: 1 / -1;
        margin-bottom: var(--space-md);
      }
    }

    /* Smart 2-column layout for tablets and small laptops */
    @media (max-width: 768px) {
      .footer-content {
        grid-template-columns: 1fr 1fr;
        gap: var(--space-lg);
        text-align: left;
        /* Keep left-aligned for better readability */
      }

      .footer-section:first-child {
        grid-column: 1 / -1;
        text-align: center;
        margin-bottom: var(--space-lg);
        padding-bottom: var(--space-lg);
        border-bottom: 1px solid var(--color-border);
      }

      /* Make sure Quick Links and Contact sit side by side */
      .footer-section:nth-child(2),
      .footer-section:nth-child(3) {
        text-align: left;
      }
    }

    /* Compact mobile layout */
    @media (max-width: 480px) {
      .main-footer {
        padding: var(--space-xl) 0 var(--space-md) 0;
      }

      .footer-content {
        grid-template-columns: 1fr 1fr;
        gap: var(--space-md);
        text-align: left;
      }

      .footer-section:first-child {
        grid-column: 1 / -1;
        text-align: center;
        margin-bottom: var(--space-md);
        padding-bottom: var(--space-md);
      }

      /* Compact headings on mobile */
      .footer-heading {
        font-size: 1rem;
        line-height: 1.3;
      }

      .footer-subheading {
        font-size: 0.75rem;
        margin-bottom: var(--space-xs);
      }

      .footer-description {
        font-size: 0.8rem;
        line-height: 1.5;
      }

      .footer-links {
        gap: var(--space-xs);
      }

      .footer-link {
        font-size: 0.8rem;
      }

      /* Compact bottom section */
      .footer-bottom {
        flex-direction: column;
        gap: var(--space-xs);
        text-align: center;
        padding-top: var(--space-md);
      }

      .footer-copyright,
      .footer-credits {
        font-size: 0.7rem;
        line-height: 1.4;
      }
    }

    /* Very small screens - keep 2 columns but make more compact */
    @media (max-width: 320px) {
      .footer-content {
        gap: var(--space-sm);
      }

      .footer-section:first-child {
        margin-bottom: var(--space-sm);
        padding-bottom: var(--space-sm);
      }

      .footer-heading {
        font-size: 0.9rem;
      }

      .footer-subheading {
        font-size: 0.7rem;
      }
    }

    /* Theme Toggle */
    .theme-toggle {
      background: none;
      border: 1px solid var(--color-border);
      color: var(--color-text-primary);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-base);
      position: relative;
    }

    .theme-toggle:hover {
      background-color: var(--color-surface-hover);
      border-color: var(--color-accent);
    }

    .theme-toggle svg {
      width: 20px;
      height: 20px;
      transition: transform var(--transition-base);
    }

    .theme-toggle:hover svg {
      transform: rotate(180deg);
    }

    .theme-icon {
      position: absolute;
      transition: opacity var(--transition-base);
    }

    .theme-icon.sun {
      opacity: 1;
    }

    .theme-icon.moon {
      opacity: 0;
    }

    [data-theme="dark"] .theme-icon.sun {
      opacity: 0;
    }

    [data-theme="dark"] .theme-icon.moon {
      opacity: 1;
    }

    /* Week Navigation with Stats */
    .week-nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: var(--space-xl);
      background-color: var(--color-bg);
      padding: 24px 32px;
      border-radius: var(--border-radius-xl);
      box-shadow: var(--shadow-lg);
      position: relative;
    }

    .week-nav__info {
      display: flex;
      flex-direction: column;
      gap: var(--space-xs);
    }

    .week-nav__current {
      font-size: 28px;
      font-weight: 700;
      color: var(--color-text-primary);
      letter-spacing: -0.02em;
    }

    .week-nav__stats {
      font-size: 14px;
      color: var(--color-text-secondary);
      display: flex;
      gap: var(--space-lg);
    }

    /* Time Context Section */
    .time-context {
      /**background-color: var(--color-surface);
      border-radius: var(--border-radius);
      padding: var(--space-md);
      margin-bottom: var(--space-lg);**/
      background: linear-gradient(135deg, var(--color-surface) 0%, rgba(0, 122, 255, 0.05) 100%);
      border-radius: var(--border-radius-lg);
      padding: var(--space-lg);
      margin-top: var(--space-xl);
      margin-bottom: var(--space-xl);
      box-shadow: var(--shadow-sm);
      display: none;
    }

    .happening-now {
      /**background-color: var(--color-bg);
      border-left: 3px solid var(--color-accent);
      padding: var(--space-sm);
      background: white;**/
      border-left: 4px solid #007aff;
      padding: var(--space-md);
      border-radius: var(--border-radius);
      margin-bottom: var(--space-md);
      box-shadow: var(--shadow-sm);
    }

    [data-theme="dark"] .happening-now {
      background: var(--color-surface);
    }

    .time-context.active {
      display: block;
    }

    .time-context__header {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--color-text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: var(--space-sm);
    }

    .happening-now__title {
      font-weight: 600;
      color: var(--color-accent);
      margin-bottom: var(--space-xs);
    }

    .happening-now__session {
      font-size: 0.875rem;
      color: var(--color-text-primary);
    }

    .up-next {
      display: flex;
      gap: var(--space-md);
      flex-wrap: wrap;
    }

    .up-next__item {
      background-color: var(--color-bg);
      padding: var(--space-sm);
      border-radius: var(--border-radius);
      flex: 1;
      min-width: 200px;
    }

    .up-next__time {
      font-size: 0.75rem;
      color: var(--color-text-secondary);
      margin-bottom: var(--space-xs);
    }

    .up-next__countdown {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--color-campus);
      margin-bottom: var(--space-xs);
    }

    .up-next__title {
      font-size: 0.875rem;
      color: var(--color-text-primary);
    }

    @media (max-width: 767px) {
      .up-next {
        flex-direction: column;
      }
    }

    .stat-item {
      display: flex;
      align-items: center;
      gap: var(--space-xs);
    }

    .stat-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: currentColor;
    }

    .week-nav__controls {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }

    .week-nav__button {
      width: 5rem;
      height: 44px;
      border-radius: var(--border-radius-lg);
      border: none;
      background: var(--color-surface);
      color: var(--color-text-primary);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-smooth);
      box-shadow: var(--shadow-sm);
      font-size: 14px;
      font-weight: 500;
    }

    /* Special styling for prev/next buttons */
    .week-nav__button#prevWeek,
    .week-nav__button#nextWeek {
      padding: 0;
    }

    /* Today button special style */
    .week-nav__button#todayButton {
      width: auto;
      padding: 12px 24px;
      background: #007aff;
      color: white;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(0, 122, 255, 0.2);
    }

    .week-nav__button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .week-nav__button#todayButton:hover:not(:disabled) {
      background: #0051d5;
      box-shadow: 0 4px 16px rgba(0, 122, 255, 0.3);
    }

    .week-nav__button:active:not(:disabled) {
      transform: translateY(0);
    }

    .week-nav__button:disabled {
      opacity: 0.3;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* Filters */
    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-sm);
      margin-bottom: var(--space-lg);
    }

    .filter-group {
      display: flex;
      gap: var(--space-sm);
      flex-wrap: wrap;
    }

    .filter-button {
      background-color: var(--color-surface);
      border: 1px solid var(--color-border);
      color: var(--color-text-secondary);
      padding: var(--space-xs) var(--space-md);
      border-radius: 20px;
      cursor: pointer;
      transition: all var(--transition-base);
      font-size: 0.875rem;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: var(--space-xs);
    }

    .filter-button::before {
      content: '';
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: currentColor;
      opacity: 0.3;
    }

    .filter-button.active {
      background-color: var(--color-surface-hover);
      border-color: currentColor;
      color: var(--color-text-primary);
    }

    .filter-button.active::before {
      opacity: 1;
    }

    .filter-button.online {
      color: var(--color-online);
    }

    .filter-button.campus {
      color: var(--color-campus);
    }

    .filter-button.offcampus {
      color: var(--color-offcampus);
    }

    /* View Switcher */
    .view-switcher {
      display: flex;
      gap: 4px;
      background-color: var(--color-surface);
      padding: 4px;
      border-radius: 10px;
      margin-bottom: var(--space-xl);
      width: fit-content;
      box-shadow: var(--shadow-sm);
    }

    .view-button {
      background: none;
      border: none;
      color: var(--color-text-secondary);
      padding: 8px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all var(--transition-smooth);
      position: relative;
    }

    .view-button:hover {
      color: var(--color-text-primary);
    }

    .view-button.active {
      background-color: var(--color-bg);
      color: var(--color-text-primary);
      box-shadow: var(--shadow-sm);
    }

    /* Add smooth transition for active state */
    .view-button::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 8px;
      background-color: var(--color-bg);
      opacity: 0;
      transition: opacity var(--transition-smooth);
      z-index: -1;
    }

    .view-button.active::before {
      opacity: 1;
    }

    /* Mobile responsive */
    @media (max-width: 768px) {
      .view-switcher {
        width: 100%;
        justify-content: center;
        margin-bottom: var(--space-lg);
        display: none;
      }

      .view-button {
        flex: 1;
        padding: 8px 16px;
        font-size: 13px;
      }
    }

    @media (max-width: 480px) {
      .view-button {
        padding: 8px 12px;
        font-size: 12px;
      }
    }

    /* Search */
    .search-container {
      position: relative;
      margin-bottom: var(--space-lg);
    }

    .search-input {
      width: 100%;
      background-color: var(--color-bg);
      border: 1px solid var(--color-border);
      color: var(--color-text-primary);
      padding: 12px 16px 12px 44px;
      border-radius: var(--border-radius-lg);
      font-size: 15px;
      transition: all var(--transition-smooth);
      box-shadow: var(--shadow-sm);
    }

    .search-input:focus {
      outline: none;
      border-color: #007aff;
      box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
    }

    .search-input::placeholder {
      color: var(--color-text-muted);
    }

    .search-icon {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--color-text-muted);
      pointer-events: none;
      width: 20px;
      height: 20px;
    }

    /* Month Grid */
    .month-grid {
      /**gap: 2px;
      background-color: var(--color-border);
      padding: 2px;
      border-radius: var(--border-radius);**/
      display: grid;
      grid-template-columns: repeat(7, minmax(0, 1fr));
      gap: 8px;
      background-color: transparent;
      padding: 0;
      max-width: 100%;
    }

    .month-day {
      /**
      transition: all var(--transition-base);
      overflow: hidden;**/
      background-color: var(--color-surface);
      padding: var(--space-sm);
      min-height: 100px;
      border-radius: var(--border-radius);
      cursor: pointer;
      transition: all var(--transition-smooth);
      position: relative;
      box-shadow: var(--shadow-sm);
    }

    .month-day:hover:not(.outside-conference) {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .month-day:hover {
      background-color: var(--color-surface-hover);
    }

    .month-day.today {
      /**border: 2px solid var(--color-accent);**/
      border: 2px solid #007aff;
      box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
    }

    .month-day.outside-conference {
      opacity: 0.3;
      cursor: default;
    }


    .month-day-header {
      font-size: 0.875rem;
      font-weight: 600;
      margin-bottom: var(--space-xs);
      color: var(--color-text-secondary);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .month-day-sessions {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .month-day-count {
      font-size: 0.625rem;
      background-color: var(--color-bg);
      padding: 2px 6px;
      border-radius: 10px;
      color: var(--color-text-secondary);
    }

    .month-session-item {
      font-size: 0.625rem;
      padding: 2px 4px;
      margin-bottom: 2px;
      border-radius: 3px;
      background-color: var(--color-bg);
      color: var(--color-text-primary);
      display: flex;
      align-items: center;
      gap: 4px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .month-session-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background-color: var(--category-color);
      flex-shrink: 0;
    }

    .month-day-more {
      font-size: 0.625rem;
      color: var(--color-text-secondary);
      text-align: center;
      padding-top: 2px;
    }

    /* Responsive adjustments for month view */
    @media (max-width: 768px) {
      .month-grid {
        /**grid-template-columns: repeat(7, 1fr);
        font-size: 0.75rem;**/
        gap: 4px;
      }

      .month-day {
        min-height: 80px;
        /**padding: 4px;**/
        padding: 8px;
      }

      .month-session-item {
        display: none;
      }

      .month-day-sessions {
        display: flex;
        flex-wrap: wrap;
        gap: 2px;
      }

      .month-session-dot {
        width: 8px;
        height: 8px;
      }

      .day-column {
        margin-bottom: var(--space-md);
        padding: var(--space-sm);
      }

      .day-date {
        font-size: 20px;
      }
    }

    /* Week Grid */
    .week-grid {
      display: grid;
      gap: var(--space-md);
      grid-template-columns: 1fr;
      margin-bottom: var(--space-xl);
    }

    .week-grid.three-day-view {
      grid-template-columns: repeat(3, 1fr);
      overflow-x: visible;
      /* Prevent scroll on 3-day view */
    }

    .week-grid.three-day-view .day-column {
      min-width: unset;
    }

    @media (min-width: 768px) {
      .week-grid {
        grid-template-columns: repeat(7, minmax(240px, 1fr));
        gap: 16px;
        padding-bottom: var(--space-sm);
        overflow-x: auto;
      }

      .week-grid.three-day-view {
        grid-template-columns: repeat(3, 1fr);
        gap: var(--space-md);
      }

      .week-grid.three-day-view .day-column {
        min-width: unset;
      }
    }

    /* Smooth Page Transitions */
    .week-grid,
    .month-grid {
      animation: fadeInUp 400ms ease-out;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Day Column with Time Indicators */
    .day-column {
      /**background-color: white;**/
      background-color: var(--color-surface);
      border-radius: var(--border-radius-lg);
      padding: var(--space-md);
      position: relative;
      box-shadow: var(--shadow-sm);
      transition: all var(--transition-smooth);
    }

    [data-theme="dark"] .day-column {
      background-color: var(--color-surface);
    }

    .day-column:hover {
      box-shadow: var(--shadow-md);
      transform: translateY(-2px);
    }

    .day-column.today {
      border: 2px solid #007aff;
      box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
    }

    /* Day Header */
    .day-header {
      margin-bottom: var(--space-lg);
      padding-bottom: var(--space-md);
      border-bottom: 2px solid var(--color-border);
      position: relative;
      text-align: center;
    }

    .day-name {
      /**font-size: 0.875rem;**/
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--color-text-secondary);
      margin-bottom: 4px;
    }

    .day-date {
      /**font-size: 1.25rem;
      font-weight: 500;
      margin-top: var(--space-xs);**/
      font-size: 24px;
      font-weight: 700;
      color: var(--color-text-primary);
      line-height: 1;
    }

    .day-month {
      font-size: 11px;
      color: var(--color-text-secondary);
      text-transform: uppercase;
      margin-top: 4px;
    }

    .day-column.today .day-header {
      /**border-bottom-color: #007aff;**/
      border-bottom-color: var(--color-accent);
    }

    .day-column.today .day-date {
      color: var(--color-accent);
    }

    .day-column.today .day-date {
      color: #007aff;
    }

    /* Current Time Indicator */
    .time-indicator {
      position: absolute;
      left: 0;
      right: 0;
      height: 2px;
      background-color: var(--color-accent);
      box-shadow: 0 0 10px rgba(0, 217, 217, 0.5);
      z-index: 10;
      pointer-events: none;
      display: none;
      transition: top 200ms ease-out;
    }

    .time-indicator::before {
      content: '';
      position: absolute;
      left: -8px;
      top: -4px;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background-color: var(--color-accent);
      box-shadow: 0 0 0 3px rgba(0, 217, 217, 0.2);
    }

    .time-indicator-label {
      position: absolute;
      right: 8px;
      top: -20px;
      font-size: 0.625rem;
      font-weight: 600;
      color: var(--color-accent);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .day-column.has-current-time .time-indicator {
      display: block;
    }

    /* Session Density Indicator */
    .session-density {
      position: absolute;
      right: 0;
      top: 0;
      display: flex;
      gap: 2px;
    }

    .density-bar {
      width: 3px;
      height: 20px;
      background-color: var(--color-border);
      border-radius: 2px;
      transition: background-color 200ms ease;
    }

    .density-bar.filled {
      background-color: var(--color-accent);
    }


    /* Session Cards */
    .session-list {
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
    }

    .session-card {
      /**background-color: var(--color-bg);
      transition: all var(--transition-base);**/
      background-color: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: var(--border-radius);
      padding: var(--space-md);
      cursor: pointer;
      transition: all var(--transition-smooth);
      position: relative;
      overflow: hidden;
      margin-bottom: var(--space-sm);
    }

    [data-theme="dark"] .session-card {
      background-color: var(--color-bg);
    }

    .session-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
      background-color: var(--category-color);
      transition: width var(--transition-smooth);
    }

    .session-card:hover {
      /**background-color: var(--color-surface-hover);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);**/
      transform: translateX(4px);
      box-shadow: var(--shadow-md);
    }

    .session-card:hover::before {
      width: 6px;
    }

    /** Remove top coloured bar since we don't need `labtype`
    .session-card::after {
      content: '';
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      height: 3px;
      background-color: var(--lab-type-color);
      opacity: 0.6;
    }
    **/

    .session-card.online {
      --category-color: var(--color-online);
    }

    .session-card.campus {
      --category-color: var(--color-campus);
    }

    .session-card.offcampus {
      --category-color: var(--color-offcampus);
    }

    /**
    .session-card[data-lab-type="theory"] {
      --lab-type-color: var(--color-theory);
    }

    .session-card[data-lab-type="wet-lab"] {
      --lab-type-color: var(--color-wet-lab);
    }

    .session-card[data-lab-type="dry-lab"] {
      --lab-type-color: var(--color-dry-lab);
    }

    .session-card[data-lab-type="computational"] {
      --lab-type-color: var(--color-computational);
    }
    **/

    /* Current session highlight */
    .session-card.current-session {
      /**background-color: var(--color-surface);
      border: 1px solid transparent;
      box-shadow: 0 0 0 2px var(--color-accent);**/
      background-color: #e3f2ff;
      border-color: #007aff;
      box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.2);
    }

    [data-theme="dark"] .session-card.current-session {
      background-color: rgba(0, 122, 255, 0.1);
    }

    /* Red recording dot next to time */
    .session-card.current-session .session-time::before {
      content: '';
      display: inline-block;
      width: 6px;
      height: 6px;
      background-color: #f44336;
      border-radius: 50%;
      margin-right: 6px;
      box-shadow: 0 0 0 2px rgba(244, 67, 54, 0.3);
      animation: recordingDot 1.5s ease-in-out infinite;
    }

    @keyframes recordingDot {

      0%,
      100% {
        transform: scale(1);
        box-shadow: 0 0 0 2px rgba(244, 67, 54, 0.3);
      }

      50% {
        transform: scale(1.1);
        box-shadow: 0 0 0 4px rgba(244, 67, 54, 0.1);
      }
    }

    /* Subtle text color change */
    .session-card.current-session .session-time {
      color: var(--color-accent);
      font-weight: 600;
    }

    .session-card.expanded {
      background-color: var(--color-surface-hover);
    }

    .session-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: var(--space-xs);
    }

    .session-time {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--color-text-secondary);
      font-variant-numeric: tabular-nums;
    }

    .session-category-text {
      font-size: 0.625rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--category-color);
      /* Use the same color as left border */
      background-color: rgba(255, 255, 255, 0.05);
      padding: 2px 6px;
      border-radius: 4px;
    }

    .session-title {
      font-weight: 600;
      color: var(--color-text-primary);
      margin-bottom: var(--space-xs);
      line-height: 1.3;
    }

    .session-instructor {
      font-size: 0.875rem;
      color: var(--color-text-secondary);
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .instructor-name {
      font-size: 0.875rem;
      color: var(--color-text-secondary);
      font-weight: 500;
    }

    .instructor-title {
      font-size: 0.75rem;
      color: var(--color-text-muted);
      font-style: italic;
    }

    .session-capacity {
      display: none;
      /*font-size: 0.75rem;
      color: var(--color-text-muted);
      margin-top: var(--space-xs);*/
    }

    /* Style for venue display */
    .session-venue {
      font-size: 0.75rem;
      color: var(--color-text-secondary);
      margin-top: var(--space-xs);
      display: flex;
      align-items: center;
      gap: var(--space-xs);
    }

    .session-venue a {
      color: var(--color-online);
      text-decoration: none;
      transition: all var(--transition-base);
    }

    .session-venue a:hover {
      color: var(--color-accent);
      text-decoration: underline;
    }

    /* Update day header for dates */
    .day-header {
      margin-bottom: var(--space-md);
      padding-bottom: var(--space-sm);
      border-bottom: 1px solid var(--color-border);
      position: relative;
      text-align: center;
    }

    .day-name {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--color-text-secondary);
      margin-bottom: 2px;
    }

    .day-date {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--color-text-primary);
      line-height: 1;
    }

    .day-month {
      font-size: 0.625rem;
      color: var(--color-text-secondary);
      text-transform: uppercase;
      margin-top: 2px;
    }

    .session-capacity.full {
      color: var(--color-wet-lab);
    }

    .session-details {
      margin-top: var(--space-md);
      padding-top: var(--space-md);
      border-top: 1px solid var(--color-border);
      display: grid;
      grid-template-rows: 0fr;
      transition: grid-template-rows 300ms ease-out;
    }

    .session-details-inner {
      overflow: hidden;
    }

    .session-card.expanded .session-details {
      grid-template-rows: 1fr;
    }

    .session-location {
      font-size: 0.875rem;
      color: var(--color-text-secondary);
      margin-bottom: var(--space-sm);
    }

    .session-prerequisites {
      font-size: 0.875rem;
      color: var(--color-campus);
      margin-bottom: var(--space-sm);
    }

    .session-description {
      font-size: 0.875rem;
      line-height: 1.6;
      color: var(--color-text-secondary);
    }

    /* Animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes scaleIn {
      from {
        opacity: 0;
        transform: scale(0.95);
      }

      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    /* Stagger animation for cards */
    .session-card {
      animation: slideIn 400ms ease-out backwards;
    }

    .session-card:nth-child(1) {
      animation-delay: 0ms;
    }

    .session-card:nth-child(2) {
      animation-delay: 50ms;
    }

    .session-card:nth-child(3) {
      animation-delay: 100ms;
    }

    .session-card:nth-child(4) {
      animation-delay: 150ms;
    }

    .session-card:nth-child(5) {
      animation-delay: 200ms;
    }

    /* Break Cards */
    .break-card {
      /**background-color: var(--color-surface);
      border: 1px solid rgba(156, 163, 175, 0.4);
      transition: all var(--transition-base);**/
      background-color: rgba(156, 163, 175, 0.1);
      border: 1px solid rgba(156, 163, 175, 0.2);
      border-radius: var(--border-radius);
      padding: var(--space-sm) var(--space-md);
      margin: var(--space-xs) 0;
      position: relative;
      transition: all var(--transition-smooth);
      cursor: pointer;
    }

    .break-card:hover {
      /**background-color: var(--color-surface-hover);
      border-color: rgba(156, 163, 175, 0.6);**/
      background-color: rgba(156, 163, 175, 0.15);
      border-color: rgba(156, 163, 175, 0.3);
    }

    .break-card.expanded {
      background-color: rgba(156, 163, 175, 0.15);
    }

    /* Remove the left accent bar completely */
    .break-card::before,
    .break-card::after {
      display: none;
    }

    .break-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-xs);
    }

    .break-time {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--color-text-primary);
      opacity: 0.8;
      font-variant-numeric: tabular-nums;
    }

    .break-icon {
      font-size: 1rem;
      opacity: 0.7;
      color: var(--color-text-secondary);
    }

    .break-title {
      font-weight: 500;
      color: var(--color-text-primary);
      opacity: 0.85;
      font-size: 0.875rem;
      margin-bottom: 0;
    }

    /* Hide description initially, show when expanded */
    .break-description {
      font-size: 0.75rem;
      color: var(--color-text-secondary);
      font-style: italic;
      margin-top: var(--space-xs);
      display: grid;
      grid-template-rows: 0fr;
      transition: grid-template-rows 300ms ease-out;
    }

    .break-description-inner {
      overflow: hidden;
    }

    /* Show description when break card is expanded */
    .break-card.expanded .break-description {
      grid-template-rows: 1fr;
    }

    /* Dark mode improvements */
    [data-theme="dark"] .break-card {
      border-color: rgba(255, 255, 255, 0.15);
    }

    [data-theme="dark"] .break-card:hover {
      border-color: rgba(255, 255, 255, 0.25);
    }

    /* Day column stagger */
    .day-column {
      animation: scaleIn 300ms ease-out backwards;
    }

    .day-column:nth-child(1) {
      animation-delay: 0ms;
    }

    .day-column:nth-child(2) {
      animation-delay: 50ms;
    }

    .day-column:nth-child(3) {
      animation-delay: 100ms;
    }

    .day-column:nth-child(4) {
      animation-delay: 150ms;
    }

    .day-column:nth-child(5) {
      animation-delay: 200ms;
    }

    .day-column:nth-child(6) {
      animation-delay: 250ms;
    }

    .day-column:nth-child(7) {
      animation-delay: 300ms;
    }

    /* Loading State */
    .loading {
      text-align: center;
      padding: var(--space-2xl);
      color: var(--color-text-secondary);
      grid-column: 1 / -1;
      font-weight: 500;
    }

    /* Empty State */
    .empty-state {
      /**padding: var(--space-2xl);
      color: var(--color-text-secondary);**/
      text-align: center;
      padding: var(--space-xl);
      color: var(--color-text-muted);
      background-color: var(--color-surface);
      border-radius: var(--border-radius);
      border: 2px dashed var(--color-border);
    }

    .loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-md);
    }

    .loading::before {
      content: '';
      width: 40px;
      height: 40px;
      border: 3px solid var(--color-border);
      border-top-color: #007aff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    /* Mobile Optimizations */
    @media (max-width: 768px) {
      .container {
        max-width: var(--container-max);
        margin: 0 auto;
        padding: var(--space-md);
        padding-top: 0;
      }

      .theme-toggle {
        position: absolute;
        top: var(--space-md);
        right: var(--space-md);
      }

      .week-nav {
        padding: 20px;
        flex-direction: column;
        gap: var(--space-md);
      }

      .week-nav__current {
        font-size: 24px;
        text-align: center;
      }

      .week-nav__stats {
        justify-content: center;
        font-size: 13px;
        gap: var(--space-md);
      }

      .week-nav__controls {
        width: 100%;
        justify-content: center;
      }

      .week-nav__button {
        width: 48px;
        height: 48px;
      }

      .week-nav__button#todayButton {
        flex: 1;
        max-width: 120px;
      }

      /* Filters */
      .filters {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-sm);
        margin-bottom: var(--space-md);
        align-items: center;
      }

      .filter-group {
        display: flex;
        gap: var(--space-sm);
        flex-wrap: wrap;
        background-color: var(--color-surface);
        padding: 4px;
        border-radius: 10px;
        box-shadow: var(--shadow-sm);
      }

      .filter-button {
        background-color: transparent;
        border: none;
        color: var(--color-text-secondary);
        padding: 8px 16px;
        border-radius: 8px;
        cursor: pointer;
        transition: all var(--transition-smooth);
        font-size: 14px;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: var(--space-xs);
      }

      .filter-button::before {
        content: '';
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background-color: currentColor;
        opacity: 0.5;
        transition: all var(--transition-smooth);
      }

      .filter-button:hover {
        background-color: rgba(0, 0, 0, 0.05);
        color: var(--color-text-primary);
      }

      [data-theme="dark"] .filter-button:hover {
        background-color: rgba(255, 255, 255, 0.1);
      }

      .filter-button.active {
        background-color: white;
        color: var(--color-text-primary);
        box-shadow: var(--shadow-sm);
      }

      [data-theme="dark"] .filter-button.active {
        background-color: #2a2a2a;
        color: var(--color-text-primary);
      }

      .filter-button.active::before {
        opacity: 1;
        transform: scale(1.2);
      }

      /* Maintain category colors */
      .filter-button.online {
        color: var(--color-online);
      }

      .filter-button.campus {
        color: var(--color-campus);
      }

      .filter-button.offcampus {
        color: var(--color-offcampus);
      }

      @media (max-width: 768px) {
        .filters {
          justify-content: center;
        }

        .filter-group {
          width: 100%;
          justify-content: center;
        }

        .search-container {
          margin-bottom: var(--space-md);
        }

        .search-input {
          font-size: 16px;
          /* Prevent zoom on iOS */
        }
      }

      @media (max-width: 480px) {
        .filter-button {
          padding: 6px 12px;
          font-size: 13px;
        }

        .filter-button::before {
          width: 6px;
          height: 6px;
        }
      }
    }

    @media (max-width: 480px) {
      .week-nav {
        padding: 16px;
        margin-bottom: var(--space-lg);
      }

      .week-nav__current {
        font-size: 20px;
      }

      .week-nav__stats {
        font-size: 12px;
      }
    }

    /* Utility Classes */
    .hidden {
      display: none !important;
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    /* Modal Styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.7);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: var(--space-md);
      backdrop-filter: blur(4px);
      opacity: 0;
      transition: opacity 200ms ease-out;
    }

    .modal-overlay.active {
      display: flex;
      opacity: 1;
    }

    /* Enhanced Modal */
    .modal-overlay {
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }

    .modal-container {
      animation: modalSlideIn 300ms ease-out;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: scale(0.95) translateY(20px);
      }

      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    .modal-container {
      background-color: var(--color-bg);
      border-radius: var(--border-radius);
      width: 100%;
      max-width: 600px;
      max-height: 90vh;
      display: flex;
      flex-direction: column;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      transform: scale(0.9);
      transition: transform 200ms ease-out;
    }

    .modal-overlay.active .modal-container {
      transform: scale(1);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--space-lg);
      border-bottom: 1px solid var(--color-border);
    }

    .modal-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--color-text-primary);
      margin: 0;
    }

    .modal-close {
      background: none;
      border: none;
      color: var(--color-text-secondary);
      cursor: pointer;
      padding: var(--space-xs);
      border-radius: var(--border-radius);
      transition: all var(--transition-base);
    }

    .modal-close:hover {
      background-color: var(--color-surface);
      color: var(--color-text-primary);
    }

    .modal-body {
      flex: 1;
      overflow-y: auto;
      padding: var(--space-lg);
    }

    /* Day view in modal */
    .modal-day-view {
      min-height: 400px;
    }

    .modal-day-header {
      text-align: center;
      margin-bottom: var(--space-lg);
      padding-bottom: var(--space-md);
      border-bottom: 1px solid var(--color-border);
    }

    .modal-day-date {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--color-text-primary);
      margin-bottom: var(--space-xs);
    }

    .modal-day-weekday {
      font-size: 0.875rem;
      color: var(--color-text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Session list in modal */
    .modal-session-list {
      display: flex;
      flex-direction: column;
      gap: var(--space-md);
    }

    /* Mobile responsiveness for modal */
    @media (max-width: 767px) {
      .modal-overlay {
        padding: 0;
      }

      .modal-container {
        max-width: 100%;
        max-height: 100%;
        height: 100%;
        border-radius: 0;
      }
    }

    /* Mobile Bottom Navigation */
    .mobile-bottom-nav {
      display: none;
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--color-bg);
      border-top: 1px solid var(--color-border);
      padding: 8px 16px;
      z-index: 100;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
    }

    .mobile-bottom-nav-inner {
      display: flex;
      justify-content: space-around;
      align-items: center;
      max-width: 400px;
      margin: 0 auto;
    }

    .bottom-nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding: 8px 16px;
      color: var(--color-text-secondary);
      background: none;
      border: none;
      cursor: pointer;
      transition: all var(--transition-smooth);
      font-size: 12px;
      text-decoration: none;
    }

    .bottom-nav-item:hover {
      color: var(--color-text-primary);
    }

    .bottom-nav-item.active {
      color: #007aff;
    }

    .bottom-nav-icon {
      width: 24px;
      height: 24px;
      fill: currentColor;
    }

    /* Show on mobile only */
    @media (max-width: 768px) {
      .mobile-bottom-nav {
        display: block;
      }

      /* Add padding to main container to account for bottom nav */
      .container {
        padding-bottom: 80px;
      }

      /* Adjust footer margin */
      .main-footer {
        margin-bottom: 80px;
      }
    }

    /* Improved Focus States */
    button:focus-visible,
    .session-card:focus-visible,
    .filter-button:focus-visible {
      outline: 2px solid #007aff;
      outline-offset: 2px;
    }

    /* Hover Refinements */
    @media (hover: hover) {
      .session-card:hover {
        transform: translateX(4px) translateY(-1px);
      }

      .month-day:hover:not(.outside-conference) {
        transform: translateY(-4px);
      }
    }

    /* Print Styles */
    @media print {

      .week-nav__controls,
      .filters,
      .search-container,
      .view-switcher,
      .mobile-bottom-nav,
      .theme-toggle {
        display: none !important;
      }

      .week-grid {
        grid-template-columns: repeat(7, 1fr) !important;
        overflow: visible !important;
      }

      .session-card {
        break-inside: avoid;
      }
    }
  </style>
</head>

<body>
  <header class="main-header">
    <div class="header-container">
      <div class="header-left">
        <div class="logo-section">
          <img src="./assets/logo-colour.svg" alt="Course Logo" class="header-logo light-logo">
          <img src="./assets/logo-dark.svg" alt="Course Logo" class="header-logo dark-logo">
        </div>
        <div class="header-text">
          <h1 class="course-title">
            <span class="title-full">Professional Course in Advanced Microscopy</span>
            <span class="title-short">Advanced Microscopy Course</span>
          </h1>
          <p class="course-subtitle">by Ashoka University and ZEISS Research Microscopy Solutions</p>
        </div>
      </div>
      <div class="header-right">
        <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
          <svg class="theme-icon sun" fill="currentColor" viewBox="0 0 20 20">
            <path
              d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" />
          </svg>
          <svg class="theme-icon moon" fill="currentColor" viewBox="0 0 20 20">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
          </svg>
        </button>
      </div>
    </div>
  </header>

  <div class="container">
    <nav class="week-nav" role="navigation" aria-label="Week navigation">
      <div class="week-nav__info" id="currentWeek">
        <div class="week-nav__current">Loading...</div>
        <div class="week-nav__stats"></div>
      </div>
      <div class="week-nav__controls">
        <button class="week-nav__button" id="prevWeek" aria-label="Previous week">
           Prev
        </button>
        <button class="week-nav__button" id="todayButton" aria-label="Go to today">
          Today
        </button>
        <button class="week-nav__button" id="nextWeek" aria-label="Next week">
           Next
        </button>
      </div>
    </nav>

    <div class="filters" role="group" aria-label="Filter sessions by category">
      <div class="filter-group">
        <button class="filter-button online active" data-category="online" aria-pressed="true">
          Live Online
        </button>
        <button class="filter-button campus active" data-category="campus" aria-pressed="true">
          Classroom
        </button>
        <button class="filter-button offcampus active" data-category="offcampus" aria-pressed="true">
          Lab
        </button>
      </div>
    </div>

    <div class="search-container">
      <svg class="search-icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
        <path
          d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
      </svg>
      <input type="search" class="search-input" placeholder="Search sessions or instructors..." id="searchInput"
        aria-label="Search sessions">
    </div>

    <div class="view-switcher" role="tablist" aria-label="View options">
      <button class="view-button active" role="tab" data-view="month" aria-selected="false">Month</button>
      <button class="view-button" role="tab" data-view="week" aria-selected="true">Week</button>
      <!--<button class="view-button" role="tab" data-view="3day" aria-selected="false">3 Days</button>-->
    </div>

    <main class="week-grid" id="weekGrid" role="main">
      <div class="loading">Loading schedule...</div>
    </main>

    <div class="time-context" id="timeContext">
      <div class="happening-now" id="happeningNow" style="display: none;">
        <div class="happening-now__title">Happening Now</div>
        <div class="happening-now__session" id="currentSession"></div>
      </div>

      <div class="up-next-section">
        <div class="time-context__header">Up Next</div>
        <div class="up-next" id="upNext"></div>
      </div>
    </div>

  </div>
  <!-- Day Modal -->
  <div class="modal-overlay" id="dayModalOverlay">
    <div class="modal-container">
      <div class="modal-header">
        <h2 class="modal-title" id="modalTitle">Day Schedule</h2>
        <button class="modal-close" id="modalClose" aria-label="Close modal">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
          </svg>
        </button>
      </div>
      <div class="modal-body" id="modalBody">
        <!-- Day view will be rendered here -->
      </div>
    </div>
  </div>

  <footer class="main-footer">
    <div class="footer-container">
      <div class="footer-content">
        <!-- Course Info Section -->
        <div class="footer-section">
          <h3 class="footer-heading">Professional Course in Advanced Microscopy</h3>
          <p class="footer-description">
            A collaborative program by Ashoka University and ZEISS Research Microscopy Solutions
          </p>
        </div>

        <!-- Quick Links Section -->
        <div class="footer-section">
          <h4 class="footer-subheading">Quick Links</h4>
          <ul class="footer-links">
            <li><a href="#about" class="footer-link">About the Course</a></li>
            <li><a href="https://www.linkedin.com/company/global-research-alliances-ashoka-university/" target="_blank"
                rel="noopener noreferrer" class="footer-link">LinkedIn</a></li>
          </ul>
        </div>

        <!-- Contact Section -->
        <div class="footer-section">
          <h4 class="footer-subheading">Contact</h4>
          <ul class="footer-links">
            <li><a href="mailto:ashokazeiss_coreimagingfacility@ashoka.edu.in" class="footer-link">Email Support</a>
            </li>
          </ul>
        </div>
      </div>

      <!-- Footer Bottom -->
      <div class="footer-bottom">
        <div class="footer-bottom-left">
          <p class="footer-copyright">
             2025 Professional Course in Advanced Microscopy. All rights reserved.
          </p>
        </div>
        <div class="footer-bottom-right">
          <p class="footer-credits">
            Built by <a href="https://deeprajpandey.com" target="_blank" rel="noopener noreferrer"
              class="footer-link">Deepraj Pandey</a>
          </p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Mobile Bottom Navigation -->
  <nav class="mobile-bottom-nav">
    <div class="mobile-bottom-nav-inner">
      <button class="bottom-nav-item active" onclick='document.querySelector("[data-view=month]").click()'>
        <svg class="bottom-nav-icon" viewBox="0 0 24 24">
          <path
            d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11z" />
        </svg>
        <span>Calendar</span>
      </button>
      <button class="bottom-nav-item" onclick='document.querySelector("[data-view=week]").click()'>
        <svg class="bottom-nav-icon" viewBox="0 0 24 24">
          <path
            d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z" />
        </svg>
        <span>Week</span>
      </button>
      <button class="bottom-nav-item" onclick='document.getElementById("searchInput").focus(); window.scrollTo(0, 0);'>
        <svg class="bottom-nav-icon" viewBox="0 0 24 24">
          <path
            d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
        </svg>
        <span>Search</span>
      </button>
    </div>
  </nav>

  <script>
    // Sample JSON data structure (in production, this would be in a separate file)
    const CONFERENCE_DATA = null;

    // Namespace for our application
    const ConferenceSchedule = (() => {
      'use strict';

      // State management
      const state = {
        currentWeekStart: null,
        sessions: [],
        filteredSessions: [],
        activeFilters: new Set(['online', 'campus', 'offcampus']),
        searchQuery: '',
        expandedSessions: new Set(),
        conferenceData: null,
        currentView: 'month'
      };

      // Constants
      const DAYS_IN_WEEK = 7;
      let CONFERENCE_START;
      let CONFERENCE_END;

      // Data loading and parsing
      const loadConferenceData = async () => {
        const weekGrid = document.getElementById('weekGrid');

        try {
          // Show loading state with more specific message
          weekGrid.innerHTML = `
<div class="loading" style="grid-column: 1 / -1;">
  <div style="margin-bottom: var(--space-md);">Loading conference schedule...</div>
  <div style="font-size: 0.875rem; color: var(--color-text-secondary);">
    Fetching latest data from GitHub Pages
  </div>
</div>
`;

          // Fetch with timeout and cache-busting for immediate updates
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 second timeout

          const response = await fetch(`./data/conference.json?v=${Date.now()}`, {
            signal: controller.signal,
            headers: {
              'Cache-Control': 'no-cache, no-store, must-revalidate',
              'Pragma': 'no-cache',
              'Expires': '0'
            }
          });

          clearTimeout(timeoutId);

          // Handle different HTTP error scenarios
          if (!response.ok) {
            throw new Error(`Failed to fetch schedule data (${response.status}: ${response.statusText})`);
          }

          // Parse JSON with error handling
          let jsonData;
          try {
            jsonData = await response.json();
          } catch (parseError) {
            throw new Error('Schedule data is corrupted or invalid. Please try again in a moment.');
          }

          // Validate required data structure
          if (!jsonData || !jsonData.schedule || !Array.isArray(jsonData.schedule)) {
            throw new Error('Schedule data is missing required information. Please contact support.');
          }

          if (!jsonData.metadata || !jsonData.metadata.conferenceStart || !jsonData.metadata.conferenceEnd) {
            throw new Error('Conference dates are missing. Please contact support.');
          }

          // Validate that we have actual sessions
          if (jsonData.schedule.length === 0) {
            // This might be intentional (no sessions yet), so handle gracefully
            // This might be intentional (no sessions yet), so handle gracefully
            weekGrid.className = ''; // Remove grid class to prevent overflow
            weekGrid.innerHTML = `
              <div class="empty-state" style="
                max-width: 600px;
                margin: 0 auto;
                padding: var(--space-2xl);
                text-align: center;
                background-color: var(--color-surface);
                border-radius: var(--border-radius-lg);
                box-shadow: var(--shadow-sm);
              ">
                <h3 style="margin-bottom: var(--space-md);">No Sessions Scheduled Yet</h3>
                <p style="color: var(--color-text-secondary); margin-bottom: var(--space-lg);">
                  The conference schedule is being updated. Please check back later.
                </p>
                <button class="week-nav__button" onclick="window.location.reload()" style="
                  width: auto;
                  padding: 12px 24px;
                  background: #007aff;
                  color: white;
                  border: none;
                  font-weight: 600;
                  display: block;
                  margin: 0 auto;
                ">
                  Refresh Schedule
                </button>
              </div>
            `;
            return false;
          }

          // Success - store data and continue
          state.conferenceData = jsonData;
          CONFERENCE_START = new Date(state.conferenceData.metadata.conferenceStart);
          CONFERENCE_END = new Date(state.conferenceData.metadata.conferenceEnd);
          state.sessions = state.conferenceData.schedule;

          console.log(` Loaded ${jsonData.schedule.length} sessions successfully`);
          return true;

        } catch (error) {
          console.error('Data loading failed:', error);

          // Handle specific error types with user-friendly messages
          let errorMessage = 'Unable to load the conference schedule';
          let errorDetails = error.message;
          let showRetry = true;

          if (error.name === 'AbortError') {
            errorMessage = 'Loading is taking longer than expected';
            errorDetails = 'Please check your internet connection and try again.';
          } else if (error.message.includes('Failed to fetch')) {
            errorMessage = 'Cannot connect to the schedule server';
            errorDetails = 'Please check your internet connection or try again in a moment.';
          } else if (error.message.includes('404')) {
            errorMessage = 'Schedule not found';
            errorDetails = 'The schedule file may not be published yet. Please try again later.';
          } else if (error.message.includes('corrupted') || error.message.includes('invalid')) {
            errorMessage = 'Schedule data error';
            errorDetails = error.message;
          }

          // Show comprehensive error UI
          weekGrid.className = '';
          weekGrid.innerHTML = `
            <div class="error-state" style="
              grid-column: 1 / -1;
              padding: var(--space-xl);
              text-align: center;
              background-color: var(--color-surface);
              border-radius: var(--border-radius-lg);
              border-left: 4px solid #ff3b30;
              max-width: 600px;
              margin: 0 auto;
              box-shadow: var(--shadow-md);
            ">
              <div style="margin-bottom: var(--space-lg);">
                <h3 style="color: #ff3b30; margin-bottom: var(--space-sm); font-size: 1.25rem;">
                  ${errorMessage}
                </h3>
                <p style="color: var(--color-text-secondary); margin-bottom: var(--space-lg); line-height: 1.6;">
                  ${errorDetails}
                </p>
                <button class="week-nav__button" onclick="window.location.reload()" style="
                  width: auto;
                  padding: 12px 24px;
                  background: #007aff;
                  color: white;
                  border: none;
                  font-weight: 600;
                  margin: 0 auto;
                ">
                   Refresh Page
                </button>
              </div>

              <details style="text-align: left;">
                <summary style="cursor: pointer; color: var(--color-text-secondary); font-size: 0.875rem; padding: var(--space-sm) 0;">
                  Technical Details
                </summary>
                <div style="
                  margin-top: var(--space-sm);
                  padding: var(--space-md);
                  background-color: var(--color-bg);
                  border-radius: 8px;
                  font-family: monospace;
                  font-size: 0.75rem;
                  color: var(--color-text-muted);
                  word-break: break-word;
                  overflow-wrap: break-word;
                  white-space: pre-wrap;
                ">
            Error: ${error.name || 'Unknown'}
            Message: ${error.message}
            Time: ${new Date().toLocaleString()}
            URL: ${window.location.href}
                </div>
              </details>
            </div>
          `;

          return false;
        }
      };

      // Utility functions
      const addMinutes = (time, minutes) => {
        const [h, m] = time.split(':').map(Number);
        const totalMinutes = h * 60 + m + minutes;
        const newHours = Math.floor(totalMinutes / 60);
        const newMinutes = totalMinutes % 60;
        return `${newHours.toString().padStart(2, '0')}:${newMinutes.toString().padStart(2, '0')}`;
      };

      const formatDate = (date) => {
        const options = {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'};
        return date.toLocaleDateString('en-US', options);
      };

      const getWeekStart = (date) => {
        const d = new Date(date);
        const day = d.getDay();
        const diff = d.getDate() - day;
        return new Date(d.setDate(diff));
      };

      const getWeekDates = (weekStart) => {
        const dates = [];
        for (let i = 0; i < DAYS_IN_WEEK; i++) {
          const date = new Date(weekStart);
          date.setDate(weekStart.getDate() + i);
          dates.push(date);
        }
        return dates;
      };

      const isToday = (date) => {
        const today = new Date();
        return date.toDateString() === today.toDateString();
      };

      // Filtering logic
      const filterSessions = () => {
        state.filteredSessions = state.sessions.filter(session => {
          // Always show breaks regardless of filters
          if (session.type === 'break') {
            return true;
          }
          // Category filter
          if (!state.activeFilters.has(session.category)) {
            return false;
          }

          // Search filter
          if (state.searchQuery) {
            const query = state.searchQuery.toLowerCase();
            const matchesTitle = session.title.toLowerCase().includes(query);
            const matchesInstructor = session.instructor.toLowerCase().includes(query);
            if (!matchesTitle && !matchesInstructor) {
              return false;
            }
          }

          return true;
        });
      };

      // DOM manipulation
      const renderWeek = () => {
        const weekGrid = document.getElementById('weekGrid');
        weekGrid.className = 'week-grid'; // Reset to just week-grid
        const weekDates = getWeekDates(state.currentWeekStart);

        // Clear existing content
        weekGrid.innerHTML = '';

        // Calculate stats for the week
        const weekStats = calculateWeekStats(weekDates);

        // Update week navigation with stats
        updateWeekNavigation(weekStats);

        // Render each day
        weekDates.forEach((date, index) => {
          const dayColumn = createDayColumn(date);
          weekGrid.appendChild(dayColumn);
        });

        // Update current time indicator
        updateTimeIndicator();

        // Update navigation buttons
        updateNavigationButtons();
      };

      const renderView = () => {
        let dates = [];

        switch (state.currentView) {
          case 'month':
            // For month view, we'll calculate stats differently
            renderMonth();
            const monthStats = calculateWeekStats([]); // Pass empty array, function handles month logic
            updateWeekNavigation(monthStats);
            break;

          case '3day':
            render3Day();
            // Calculate stats for 3 days
            const today = new Date();
            dates = [];
            for (let i = 0; i < 3; i++) {
              const date = new Date(today);
              date.setDate(today.getDate() + i);
              dates.push(date);
            }
            const threeDayStats = calculateWeekStats(dates);
            updateWeekNavigation(threeDayStats);
            break;

          default:
            renderWeek();
          // Stats are calculated within renderWeek
        }

        // Update indicators
        updateTimeContext();
        updateNavigationButtons();    // Ensure navigation buttons are updated
        updateTimeIndicator();
        highlightCurrentSession();
      };

      const renderMonth = () => {
        const weekGrid = document.getElementById('weekGrid');
        weekGrid.innerHTML = '';
        weekGrid.className = 'month-grid';

        // Get first day of month
        const monthStart = new Date(state.currentWeekStart);
        monthStart.setDate(1);

        // Get last day of month
        const monthEnd = new Date(monthStart);
        monthEnd.setMonth(monthEnd.getMonth() + 1);
        monthEnd.setDate(0);

        // Add day headers
        const dayHeaders = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        dayHeaders.forEach(day => {
          const header = document.createElement('div');
          header.className = 'month-day-header';
          header.textContent = day;
          header.style.textAlign = 'center';
          weekGrid.appendChild(header);
        });

        // Add empty cells for start of month
        const startDay = monthStart.getDay();
        for (let i = 0; i < startDay; i++) {
          const emptyDay = document.createElement('div');
          emptyDay.className = 'month-day empty';
          weekGrid.appendChild(emptyDay);
        }

        // Add days
        for (let d = new Date(monthStart); d <= monthEnd; d.setDate(d.getDate() + 1)) {
          const dayCell = createMonthDay(new Date(d));
          weekGrid.appendChild(dayCell);
        }
      };

      const createMonthDay = (date) => {
        const dayCell = document.createElement('div');
        const dateStr = date.toISOString().split('T')[0];
        const isOutside = date < CONFERENCE_START || date > CONFERENCE_END;

        dayCell.className = `month-day ${isToday(date) ? 'today' : ''} ${isOutside ? 'outside-conference' : ''}`;

        // Header with date and count
        const dayHeader = document.createElement('div');
        dayHeader.className = 'month-day-header';

        const dayNumber = document.createElement('span');
        dayNumber.textContent = date.getDate();

        // Get sessions for this day
        const daySessions = state.filteredSessions.filter(s => s.date === dateStr);

        dayHeader.appendChild(dayNumber);

        if (daySessions.length > 0) {
          const count = document.createElement('span');
          count.className = 'month-day-count';
          count.textContent = daySessions.length;
          dayHeader.appendChild(count);
        }

        dayCell.appendChild(dayHeader);

        // Sessions container
        const sessionsContainer = document.createElement('div');
        sessionsContainer.className = 'month-day-sessions';

        // On desktop, show session titles; on mobile, show dots
        const isMobile = window.innerWidth <= 767;

        if (!isMobile && daySessions.length > 0) {
          // Show first 2 sessions with titles
          daySessions.slice(0, 2).forEach(session => {
            const sessionItem = document.createElement('div');
            sessionItem.className = 'month-session-item';

            const dot = document.createElement('div');
            dot.className = `month-session-dot ${session.category}`;
            dot.style.setProperty('--category-color', `var(--color-${session.category})`);

            const time = document.createElement('span');
            time.textContent = session.startTime;
            time.style.marginRight = '4px';
            time.style.opacity = '0.7';

            const title = document.createElement('span');
            title.textContent = session.title.length > 20 ?
              session.title.substring(0, 20) + '...' : session.title;

            sessionItem.appendChild(dot);
            sessionItem.appendChild(time);
            sessionItem.appendChild(title);
            sessionsContainer.appendChild(sessionItem);
          });

          if (daySessions.length > 2) {
            const more = document.createElement('div');
            more.className = 'month-day-more';
            more.textContent = `+${daySessions.length - 2} more`;
            sessionsContainer.appendChild(more);
          }
        } else if (daySessions.length > 0) {
          // Mobile view - show dots
          daySessions.slice(0, 6).forEach(session => {
            const dot = document.createElement('div');
            dot.className = `month-session-dot ${session.category}`;
            dot.style.setProperty('--category-color', `var(--color-${session.category})`);
            sessionsContainer.appendChild(dot);
          });

          if (daySessions.length > 6) {
            const more = document.createElement('div');
            more.className = 'month-day-more';
            more.textContent = `+${daySessions.length - 6}`;
            more.style.width = '100%';
            sessionsContainer.appendChild(more);
          }
        }

        dayCell.appendChild(sessionsContainer);

        // Click to go to week view (unless outside conference dates)
        if (!isOutside) {
          dayCell.addEventListener('click', () => {
            openDayModal(date);
          });
          dayCell.style.cursor = 'pointer';
        } else {
          dayCell.style.cursor = 'default';
        }

        return dayCell;
      };

      const render3Day = () => {
        const weekGrid = document.getElementById('weekGrid');
        weekGrid.className = 'week-grid three-day-view';
        weekGrid.innerHTML = '';

        const dates = [];

        // Use the current start date from state
        const startDate = new Date(state.currentWeekStart);

        // Show 3 consecutive days starting from startDate
        for (let i = 0; i < 3; i++) {
          const date = new Date(startDate);
          date.setDate(startDate.getDate() + i);
          if (date <= CONFERENCE_END) {
            dates.push(date);
          }
        }

        dates.forEach(date => {
          const dayColumn = createDayColumn(date);
          weekGrid.appendChild(dayColumn);
        });

        updateTimeIndicator();
      };

      const updateViewButtons = () => {
        document.querySelectorAll('.view-button').forEach(btn => {
          const isActive = btn.dataset.view === state.currentView;
          btn.classList.toggle('active', isActive);
          btn.setAttribute('aria-selected', isActive);
        });
      };

      const calculateWeekStats = (dates) => {
        const stats = {
          total: 0,
          byCategory: {online: 0, campus: 0, offcampus: 0}
        };

        // For month view, calculate for entire month
        if (state.currentView === 'month') {
          const monthStart = new Date(state.currentWeekStart);
          monthStart.setDate(1);
          const monthEnd = new Date(monthStart);
          monthEnd.setMonth(monthEnd.getMonth() + 1);
          monthEnd.setDate(0);

          for (let d = new Date(monthStart); d <= monthEnd; d.setDate(d.getDate() + 1)) {
            const dateStr = d.toISOString().split('T')[0];
            const daySessions = state.filteredSessions.filter(s => s.date === dateStr);
            stats.total += daySessions.length;
            daySessions.forEach(session => {
              stats.byCategory[session.category]++;
            });
          }
        } else {
          // Original logic for week and 3-day views
          dates.forEach(date => {
            const dateStr = date.toISOString().split('T')[0];
            const daySessions = state.filteredSessions.filter(s => s.date === dateStr);

            stats.total += daySessions.length;
            daySessions.forEach(session => {
              stats.byCategory[session.category]++;
            });
          });
        }

        return stats;
      };

      const updateWeekNavigation = (stats) => {
        const currentWeekEl = document.getElementById('currentWeek');
        let dateRangeText = '';

        switch (state.currentView) {
          case 'month':
            const monthDate = new Date(state.currentWeekStart);
            dateRangeText = monthDate.toLocaleDateString('en-US', {month: 'long', year: 'numeric'});
            break;

          case '3day':
            const today = new Date();
            const endDate = new Date(today);
            endDate.setDate(today.getDate() + 2);
            dateRangeText = `${formatDate(today).split(',')[1].trim()} - ${formatDate(endDate).split(',')[1].trim()}`;
            break;

          default: // week view
            const weekEndDate = new Date(state.currentWeekStart);
            weekEndDate.setDate(weekEndDate.getDate() + 6);
            dateRangeText = `${formatDate(state.currentWeekStart).split(',')[1].trim()} - ${formatDate(weekEndDate).split(',')[1].trim()}`;
        }

        currentWeekEl.innerHTML = `
        <div class="week-nav__current">
            ${dateRangeText}
        </div>
        <div class="week-nav__stats">
            <div class="stat-item">
                <span>${stats.total} sessions</span>
            </div>
            <div class="stat-item" style="color: var(--color-online)">
                <span class="stat-dot"></span>
                <span>${stats.byCategory.online}</span>
            </div>
            <div class="stat-item" style="color: var(--color-campus)">
                <span class="stat-dot"></span>
                <span>${stats.byCategory.campus}</span>
            </div>
            <div class="stat-item" style="color: var(--color-offcampus)">
                <span class="stat-dot"></span>
                <span>${stats.byCategory.offcampus}</span>
            </div>
        </div>
    `;
      };

      const createDayColumn = (date) => {
        const dayColumn = document.createElement('div');
        dayColumn.className = `day-column ${isToday(date) ? 'today' : ''}`;

        // Day header with density indicator
        const dayHeader = document.createElement('div');
        dayHeader.className = 'day-header';

        const dayName = document.createElement('div');
        dayName.className = 'day-name';
        dayName.textContent = date.toLocaleDateString('en-US', {weekday: 'short'});

        const dayDate = document.createElement('div');
        dayDate.className = 'day-date';
        dayDate.textContent = date.getDate();

        const dayMonth = document.createElement('div');
        dayMonth.className = 'day-month';
        dayMonth.textContent = date.toLocaleDateString('en-US', {month: 'short'});

        dayHeader.appendChild(dayName);
        dayHeader.appendChild(dayDate);
        dayHeader.appendChild(dayMonth);

        // Session density indicator
        const dateStr = date.toISOString().split('T')[0];
        const daySessions = state.filteredSessions
          .filter(session => session.date === dateStr)
          .sort((a, b) => a.startTime.localeCompare(b.startTime));

        const densityIndicator = createDensityIndicator(daySessions.length);

        dayHeader.appendChild(dayName);
        dayHeader.appendChild(dayDate);
        dayHeader.appendChild(densityIndicator);
        dayColumn.appendChild(dayHeader);

        // Session list
        const sessionList = document.createElement('div');
        sessionList.className = 'session-list';

        if (daySessions.length === 0) {
          const emptyState = document.createElement('div');
          emptyState.className = 'empty-state';
          emptyState.textContent = 'No sessions';
          sessionList.appendChild(emptyState);
        } else {
          // Group sessions by time blocks
          const timeBlocks = groupSessionsByTimeBlock(daySessions);

          Object.entries(timeBlocks).forEach(([time, sessions]) => {
            sessions.forEach(session => {
              const sessionCard = createSessionCard(session);
              sessionList.appendChild(sessionCard);
            });
          });
        }

        dayColumn.appendChild(sessionList);

        // Add time indicator if today
        if (isToday(date)) {
          const timeIndicator = createTimeIndicator();
          dayColumn.appendChild(timeIndicator);
          dayColumn.classList.add('has-current-time');
        }

        return dayColumn;
      };

      const createDensityIndicator = (sessionCount) => {
        const densityContainer = document.createElement('div');
        densityContainer.className = 'session-density';

        const maxBars = 4;
        const filledBars = Math.min(sessionCount, maxBars);

        for (let i = 0; i < maxBars; i++) {
          const bar = document.createElement('div');
          bar.className = `density-bar ${i < filledBars ? 'filled' : ''}`;
          densityContainer.appendChild(bar);
        }

        return densityContainer;
      };

      const createTimeIndicator = () => {
        const indicator = document.createElement('div');
        indicator.className = 'time-indicator';

        const label = document.createElement('div');
        label.className = 'time-indicator-label';
        label.textContent = 'NOW';

        indicator.appendChild(label);
        return indicator;
      };

      const groupSessionsByTimeBlock = (sessions) => {
        const blocks = {};
        sessions.forEach(session => {
          const hour = parseInt(session.startTime.split(':')[0]);
          const block = hour < 12 ? 'morning' : 'afternoon';

          if (!blocks[block]) blocks[block] = [];
          blocks[block].push(session);
        });
        return blocks;
      };

      const updateTimeIndicator = () => {
        const now = new Date();
        const currentHour = now.getHours();
        const currentMinutes = now.getMinutes();
        const currentTimeStr = `${currentHour.toString().padStart(2, '0')}:${currentMinutes.toString().padStart(2, '0')}`;

        // DEBUG: Remove the hour restriction for testing
        // if (currentHour < 10 || currentHour >= 17) return;

        const todayColumn = document.querySelector('.day-column.today');
        if (!todayColumn) return;

        const indicator = todayColumn.querySelector('.time-indicator');
        if (!indicator) return;

        // Get the header height
        const dayHeader = todayColumn.querySelector('.day-header');
        if (!dayHeader) return;
        const headerHeight = dayHeader.offsetHeight;

        // Get all session cards in today's column
        const sessionCards = todayColumn.querySelectorAll('.session-card');
        if (sessionCards.length === 0) return;

        // Get today's sessions
        const todayStr = now.toISOString().split('T')[0];
        const todaySessions = state.filteredSessions
          .filter(s => s.date === todayStr)
          .sort((a, b) => a.startTime.localeCompare(b.startTime));

        if (todaySessions.length === 0) return;

        // Find which session period we're in
        let positionFound = false;
        let accumulatedHeight = headerHeight;

        sessionCards.forEach((card, index) => {
          if (positionFound) return;

          const session = todaySessions[index];
          if (!session) return;

          const cardHeight = card.offsetHeight;
          const cardTop = card.offsetTop;

          // Check if current time is within this session
          if (currentTimeStr >= session.startTime && currentTimeStr <= session.endTime) {
            // Calculate position within this session
            const [startHour, startMin] = session.startTime.split(':').map(Number);
            const [endHour, endMin] = session.endTime.split(':').map(Number);

            const sessionStartMinutes = startHour * 60 + startMin;
            const sessionEndMinutes = endHour * 60 + endMin;
            const currentMinutesTotal = currentHour * 60 + currentMinutes;

            const sessionDuration = sessionEndMinutes - sessionStartMinutes;
            const minutesIntoSession = currentMinutesTotal - sessionStartMinutes;
            const percentageIntoSession = (minutesIntoSession / sessionDuration) * 100;

            // Position within the current card
            const positionInCard = (cardHeight * percentageIntoSession) / 100;
            const totalPosition = cardTop + positionInCard;

            indicator.style.top = `${totalPosition}px`;
            positionFound = true;
          }
          // Check if we're between sessions
          else if (index < todaySessions.length - 1) {
            const nextSession = todaySessions[index + 1];
            if (currentTimeStr > session.endTime && currentTimeStr < nextSession.startTime) {
              // Position between cards
              const totalPosition = cardTop + cardHeight;
              indicator.style.top = `${totalPosition}px`;
              positionFound = true;
            }
          }

          accumulatedHeight += cardHeight;
        });

        // If time is before first session
        if (!positionFound && todaySessions.length > 0) {
          if (currentTimeStr < todaySessions[0].startTime) {
            indicator.style.top = `${headerHeight}px`;
          }
          // If time is after last session
          else if (currentTimeStr > todaySessions[todaySessions.length - 1].endTime) {
            const lastCard = sessionCards[sessionCards.length - 1];
            const totalPosition = lastCard.offsetTop + lastCard.offsetHeight;
            indicator.style.top = `${totalPosition}px`;
          }
        }
      };

      const highlightCurrentSession = () => {
        const now = new Date();
        const currentTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
        const todayStr = now.toISOString().split('T')[0];

        // Remove any existing highlights
        document.querySelectorAll('.session-card.current-session').forEach(card => {
          card.classList.remove('current-session');
        });

        // Find current session from state
        const currentSession = state.filteredSessions.find(session =>
          session.date === todayStr &&
          currentTime >= session.startTime &&
          currentTime <= session.endTime
        );

        if (!currentSession) return;

        // Only look for cards in today's column
        const todayColumn = document.querySelector('.day-column.today');
        if (!todayColumn) return;

        // Find session cards only within today's column
        const sessionCards = todayColumn.querySelectorAll('.session-card');

        sessionCards.forEach(card => {
          // Get the session time and title from this specific card
          const timeElement = card.querySelector('.session-time');
          const titleElement = card.querySelector('.session-title');

          if (timeElement && titleElement) {
            // Extract just the start time from the time range
            const timeText = timeElement.textContent;
            const startTime = timeText.split(' - ')[0].trim();

            // Check if this card matches the current session
            if (titleElement.textContent === currentSession.title &&
              startTime === currentSession.startTime) {
              card.classList.add('current-session');
              return; // Found it, stop looking
            }
          }
        });
      };

      const updateTimeContext = () => {
        const now = new Date();
        const timeContext = document.getElementById('timeContext');

        // Only show during conference dates
        if (now < CONFERENCE_START || now > CONFERENCE_END) {
          timeContext.classList.remove('active');
          return;
        }

        const todayStr = now.toISOString().split('T')[0];
        const currentTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;

        // Get today's sessions
        const todaySessions = state.filteredSessions
          .filter(s => s.date === todayStr)
          .sort((a, b) => a.startTime.localeCompare(b.startTime));

        if (todaySessions.length === 0) {
          timeContext.classList.remove('active');
          return;
        }

        timeContext.classList.add('active');

        // Find current session
        const currentSession = todaySessions.find(session =>
          currentTime >= session.startTime && currentTime <= session.endTime
        );

        // Update happening now
        const happeningNowEl = document.getElementById('happeningNow');
        const currentSessionEl = document.getElementById('currentSession');

        if (currentSession) {
          happeningNowEl.style.display = 'block';
          currentSessionEl.innerHTML = `
            <div><strong>${currentSession.title}</strong></div>
            <div style="font-size: 0.75rem; color: var(--color-text-secondary); margin-top: 4px;">
                ${currentSession.instructor}  ${currentSession.startTime} - ${currentSession.endTime}
            </div>
        `;
        } else {
          happeningNowEl.style.display = 'none';
        }

        // Find upcoming sessions
        const upcomingSessions = todaySessions.filter(session =>
          session.startTime > currentTime
        ).slice(0, 3); // Show next 3 sessions

        // Update up next
        const upNextEl = document.getElementById('upNext');

        if (upcomingSessions.length > 0) {
          upNextEl.innerHTML = upcomingSessions.map(session => {
            const countdown = getCountdown(now, session.startTime);
            return `
                <div class="up-next__item">
                    <div class="up-next__time">${session.startTime}</div>
                    <div class="up-next__countdown">${countdown}</div>
                    <div class="up-next__title">${session.title}</div>
                </div>
            `;
          }).join('');
        } else {
          upNextEl.innerHTML = '<div class="empty-state">No more sessions today</div>';
        }
      };

      const getCountdown = (now, startTime) => {
        const [hours, minutes] = startTime.split(':').map(Number);
        const sessionStart = new Date(now);
        sessionStart.setHours(hours, minutes, 0, 0);

        const diffMs = sessionStart - now;
        const diffMins = Math.floor(diffMs / 60000);
        const diffHours = Math.floor(diffMins / 60);
        const remainingMins = diffMins % 60;

        if (diffHours > 0) {
          return `in ${diffHours}h ${remainingMins}m`;
        } else if (diffMins > 0) {
          return `in ${diffMins} minutes`;
        } else {
          return 'Starting soon';
        }
      };

      const createSessionCard = (session) => {
        if (session.type === 'break') {
          return createBreakCard(session);
        }
        const card = document.createElement('article');
        card.className = `session-card ${session.category} ${state.expandedSessions.has(session.id) ? 'expanded' : ''}`;
        // FEAT: we don't need different lab types
        // card.setAttribute('data-lab-type', session.labType);
        card.setAttribute('data-session-id', session.id);
        card.setAttribute('role', 'button');
        card.setAttribute('aria-expanded', state.expandedSessions.has(session.id));
        card.setAttribute('tabindex', '0');

        // Header with time and lab type
        const header = document.createElement('div');
        header.className = 'session-header';

        const time = document.createElement('div');
        time.className = 'session-time';
        time.textContent = `${session.startTime} - ${session.endTime}`;

        const categoryText = document.createElement('div');
        categoryText.className = 'session-category-text';

        // Map category to display text
        const categoryLabels = {
          'online': 'Live Online',
          'campus': 'Classroom',
          'offcampus': 'Lab'
        };

        categoryText.textContent = categoryLabels[session.category] || session.category;

        header.appendChild(time);
        header.appendChild(categoryText);

        // Basic info
        const title = document.createElement('h3');
        title.className = 'session-title';
        title.textContent = session.title;

        const instructor = document.createElement('div');
        instructor.className = 'session-instructor';

        // Create instructor name and title
        const instructorName = document.createElement('div');
        instructorName.className = 'instructor-name';
        instructorName.textContent = session.instructor;

        const instructorTitle = document.createElement('div');
        instructorTitle.className = 'instructor-title';
        instructorTitle.textContent = session.instructorTitle;

        instructor.appendChild(instructorName);
        instructor.appendChild(instructorTitle);

        const venue = document.createElement('div');
        venue.className = 'session-venue';

        if (session.category === 'online' && session.zoomLink) {
          venue.innerHTML = ` <a href="${session.zoomLink}" target="_blank" rel="noopener noreferrer">Join Zoom</a>`;
        } else if (session.location) {
          venue.innerHTML = ` ${session.location}`;
        }

        card.appendChild(header);
        card.appendChild(title);
        card.appendChild(instructor);
        card.appendChild(venue);

        // Expanded details (no location here anymore)
        const details = document.createElement('div');
        details.className = 'session-details';

        const detailsInner = document.createElement('div');
        detailsInner.className = 'session-details-inner';

        if (session.prerequisites) {
          const prerequisites = document.createElement('div');
          prerequisites.className = 'session-prerequisites';
          prerequisites.textContent = ` Requires: ${session.prerequisites}`;
          detailsInner.appendChild(prerequisites);
        }

        const description = document.createElement('p');
        description.className = 'session-description';
        description.textContent = session.description;

        detailsInner.appendChild(description);
        details.appendChild(detailsInner);
        card.appendChild(details);

        // Event listeners
        card.addEventListener('click', (e) => {
          // Don't toggle if clicking on a link
          if (e.target.tagName === 'A') return;

          e.preventDefault();
          e.stopPropagation();
          toggleSessionExpansion(session.id);
        });

        card.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            e.stopPropagation();
            toggleSessionExpansion(session.id);
          }
        });

        return card;
      };

      const createBreakCard = (breakItem) => {
        // Icon mapping based on break type
        const getBreakIcon = (breakType) => {
          const icons = {
            coffee: '',
            breakfast: '',
            lunch: '',
            dinner: ''
          };
          return icons[breakType] || ''; // Default to coffee if type not found
        };

        const card = document.createElement('div');
        card.className = `break-card ${breakItem.category} ${state.expandedSessions.has(breakItem.id) ? 'expanded' : ''}`;
        card.setAttribute('data-break-id', breakItem.id);
        card.setAttribute('data-session-id', breakItem.id); // So it works with existing expansion logic

        card.innerHTML = `
          <div class="break-header">
            <div class="break-time">${breakItem.startTime} - ${breakItem.endTime}</div>
            <div class="break-icon">${getBreakIcon(breakItem.breakType)}</div>
          </div>
          <div class="break-title">${breakItem.title}</div>
          ${breakItem.description ? `
            <div class="break-description">
              <div class="break-description-inner">${breakItem.description}</div>
            </div>
          ` : ''}
        `;

        // Add click handler for expansion (only if there's a description)
        if (breakItem.description) {
          card.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            toggleSessionExpansion(breakItem.id);
          });

          card.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              e.stopPropagation();
              toggleSessionExpansion(breakItem.id);
            }
          });
        }

        return card;
      };

      const toggleSessionExpansion = (sessionId) => {
        if (state.expandedSessions.has(sessionId)) {
          state.expandedSessions.delete(sessionId);
        } else {
          state.expandedSessions.add(sessionId);
        }
        // Check if we're in a modal
        const modal = document.getElementById('dayModalOverlay');
        if (modal.classList.contains('active')) {
          // We're in a modal, just toggle the class without re-rendering
          const card = document.querySelector(`[data-session-id="${sessionId}"]`);
          if (card) {
            card.classList.toggle('expanded');
            card.setAttribute('aria-expanded', card.classList.contains('expanded'));
          }
        } else {
          // Regular view, re-render as before
          renderView();
        }
      };

      const updateNavigationButtons = () => {
        const prevButton = document.getElementById('prevWeek');
        const nextButton = document.getElementById('nextWeek');

        switch (state.currentView) {
          case 'month':
            // Check month boundaries
            const currentMonth = new Date(state.currentWeekStart);
            currentMonth.setDate(1);

            // Previous month check
            const prevMonth = new Date(currentMonth);
            prevMonth.setMonth(prevMonth.getMonth() - 1);
            const prevMonthEnd = new Date(prevMonth);
            prevMonthEnd.setMonth(prevMonthEnd.getMonth() + 1);
            prevMonthEnd.setDate(0);
            prevButton.disabled = prevMonthEnd < CONFERENCE_START;

            // Next month check
            const nextMonth = new Date(currentMonth);
            nextMonth.setMonth(nextMonth.getMonth() + 1);
            nextButton.disabled = nextMonth > CONFERENCE_END;
            break;

          case '3day':
            // Check 3-day boundaries
            const prev3Day = new Date(state.currentWeekStart);
            prev3Day.setDate(prev3Day.getDate() - 3);
            prevButton.disabled = prev3Day < CONFERENCE_START;

            const next3Day = new Date(state.currentWeekStart);
            next3Day.setDate(next3Day.getDate() + 3);
            nextButton.disabled = next3Day > CONFERENCE_END;
            break;

          default: // week view
            // Original week logic
            const prevWeekStart = new Date(state.currentWeekStart);
            prevWeekStart.setDate(prevWeekStart.getDate() - 7);
            prevButton.disabled = prevWeekStart < CONFERENCE_START;

            const nextWeekStart = new Date(state.currentWeekStart);
            nextWeekStart.setDate(nextWeekStart.getDate() + 7);
            nextButton.disabled = nextWeekStart > CONFERENCE_END;
            break;
        }
      };

      // Event handlers
      const handleWeekNavigation = (direction) => {
        const newDate = new Date(state.currentWeekStart);

        switch (state.currentView) {
          case 'month':
            // Navigate by month
            newDate.setMonth(newDate.getMonth() + direction);
            newDate.setDate(1); // Ensure we're on the first of the month
            break;

          case '3day':
            // Navigate by 3 days
            newDate.setDate(newDate.getDate() + (direction * 3));
            break;

          default: // week view
            // Navigate by week
            newDate.setDate(newDate.getDate() + (direction * 7));
            break;
        }

        // Check bounds based on view
        if (state.currentView === 'month') {
          // For month view, check if any part of the month is within conference dates
          const monthStart = new Date(newDate);
          const monthEnd = new Date(newDate);
          monthEnd.setMonth(monthEnd.getMonth() + 1);
          monthEnd.setDate(0);

          if (monthEnd < CONFERENCE_START || monthStart > CONFERENCE_END) {
            return; // Don't navigate outside conference months
          }
        } else {
          // For week and 3-day views
          if (newDate < CONFERENCE_START || newDate > CONFERENCE_END) {
            return;
          }
        }

        state.currentWeekStart = newDate;
        renderView();
      };

      const handleTodayButton = () => {
        const today = new Date();

        let targetDate;
        if (today >= CONFERENCE_START && today <= CONFERENCE_END) {
          targetDate = today;
        } else {
          // TODO: add helpful error that today's date is outside conference margins
          targetDate = today;
        }

        switch (state.currentView) {
          case 'month':
            // For month view, just ensure we're in the right month
            state.currentWeekStart = new Date(targetDate);
            state.currentWeekStart.setDate(1);
            break;

          case '3day':
            // For 3-day view, start from today/target date
            state.currentWeekStart = new Date(targetDate);
            break;

          default: // week view
            state.currentWeekStart = getWeekStart(targetDate);
            break;
        }

        renderView();

        // Scroll to today's column if in view
        setTimeout(() => {
          const todayColumn = document.querySelector('.day-column.today');
          if (todayColumn) {
            todayColumn.scrollIntoView({behavior: 'smooth', block: 'nearest', inline: 'center'});
          }
        }, 350);
      };

      const handleFilterToggle = (category) => {
        if (state.activeFilters.has(category)) {
          state.activeFilters.delete(category);
        } else {
          state.activeFilters.add(category);
        }
        filterSessions();
        renderView();
      };

      const handleSearch = (query) => {
        state.searchQuery = query;
        filterSessions();
        renderView();
      };

      // Add these functions after your existing functions

      const openDayModal = (date) => {
        const modal = document.getElementById('dayModalOverlay');
        const modalBody = document.getElementById('modalBody');
        const modalTitle = document.getElementById('modalTitle');

        // Format the date for display
        const dateStr = date.toISOString().split('T')[0];
        const formattedDate = date.toLocaleDateString('en-US', {
          weekday: 'long',
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        });

        modalTitle.textContent = formattedDate;

        // Create day view content
        modalBody.innerHTML = '';

        const dayView = document.createElement('div');
        dayView.className = 'modal-day-view';

        // Get sessions for this day
        const daySessions = state.filteredSessions
          .filter(session => session.date === dateStr)
          .sort((a, b) => a.startTime.localeCompare(b.startTime));

        // Create session list
        const sessionList = document.createElement('div');
        sessionList.className = 'modal-session-list';

        if (daySessions.length === 0) {
          const emptyState = document.createElement('div');
          emptyState.className = 'empty-state';
          emptyState.textContent = 'No sessions scheduled for this day';
          emptyState.style.textAlign = 'center';
          emptyState.style.padding = 'var(--space-2xl)';
          sessionList.appendChild(emptyState);
        } else {
          daySessions.forEach(session => {
            const sessionCard = createSessionCard(session);
            sessionList.appendChild(sessionCard);
          });
        }

        dayView.appendChild(sessionList);
        modalBody.appendChild(dayView);

        // Show modal with animation
        modal.classList.add('active');
        document.body.style.overflow = 'hidden'; // Prevent background scrolling
      };

      const closeDayModal = () => {
        const modal = document.getElementById('dayModalOverlay');
        modal.classList.remove('active');
        document.body.style.overflow = ''; // Restore scrolling
      };

      // Update mobile nav active state
      const updateMobileNavActiveState = () => {
        const activeView = state.currentView;
        document.querySelectorAll('.bottom-nav-item').forEach(item => {
          item.classList.remove('active');
        });

        if (activeView === 'month') {
          document.querySelector('.bottom-nav-item:nth-child(1)').classList.add('active');
        } else if (activeView === 'week' || activeView === '3day') {
          document.querySelector('.bottom-nav-item:nth-child(2)').classList.add('active');
        }
      };


      // Initialize
      const init = async () => {
        // Set initial theme
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);

        // Show loading state
        const weekGrid = document.getElementById('weekGrid');
        weekGrid.innerHTML = '<div class="loading">Loading schedule...</div>';

        // Load conference data
        const dataLoaded = await loadConferenceData();
        if (!dataLoaded) {
          // Error UI is already shown by loadConferenceData
          return;
        }

        // TODO: add error handling when today is outside conference boundaries
        // Set initial date to today (regardless of conference dates)
        const today = new Date();
        if (state.currentView === 'month') {
          // For month view, set to first day of current month
          // state.currentWeekStart = new Date(today.getFullYear(), today.getMonth(), 1);
          state.currentWeekStart = getWeekStart(today);
        } else {
          // For week view, set to start of current week
          state.currentWeekStart = getWeekStart(today);
        }

        // Initialize modal event listeners (add this to your init function)
        const initializeModal = () => {
          const modal = document.getElementById('dayModalOverlay');
          const closeButton = document.getElementById('modalClose');

          // Close on button click
          closeButton.addEventListener('click', closeDayModal);

          // Close on overlay click
          modal.addEventListener('click', (e) => {
            if (e.target === modal) {
              closeDayModal();
            }
          });

          // Close on Escape key
          document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && modal.classList.contains('active')) {
              closeDayModal();
            }
          });
        };

        // Initial filter
        filterSessions();

        // Attach event listeners
        document.getElementById('prevWeek').addEventListener('click', () => handleWeekNavigation(-1));
        document.getElementById('nextWeek').addEventListener('click', () => handleWeekNavigation(1));
        document.getElementById('todayButton').addEventListener('click', handleTodayButton);

        // Theme toggle
        document.getElementById('themeToggle').addEventListener('click', () => {
          const currentTheme = document.documentElement.getAttribute('data-theme');
          const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
          document.documentElement.setAttribute('data-theme', newTheme);
          localStorage.setItem('theme', newTheme);
        });

        // View switcher
        document.querySelectorAll('.view-button').forEach(button => {
          button.addEventListener('click', () => {
            state.currentView = button.dataset.view;
            updateViewButtons();
            renderView();
            updateNavigationButtons();
            updateMobileNavActiveState();
          });
        });

        // Filter buttons
        document.querySelectorAll('.filter-button').forEach(button => {
          button.addEventListener('click', () => {
            const category = button.dataset.category;
            button.classList.toggle('active');
            button.setAttribute('aria-pressed', button.classList.contains('active'));
            handleFilterToggle(category);
          });
        });

        // Search input
        const searchInput = document.getElementById('searchInput');
        let searchTimeout;
        searchInput.addEventListener('input', (e) => {
          clearTimeout(searchTimeout);
          searchTimeout = setTimeout(() => {
            handleSearch(e.target.value);
          }, 300); // Debounce search
        });

        // Render initial view
        renderView();

        // Update time indicator every minute
        setInterval(updateTimeIndicator, 60000);

        // Initial highlight
        highlightCurrentSession();

        // Initial time context update
        updateTimeContext();

        initializeModal();
      };

      // Public API
      return {
        init
      };
    })();

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', ConferenceSchedule.init);
    } else {
      ConferenceSchedule.init();
    }
  </script>
</body>

</html>
